<div class="container">
    <div class="row">
        <div class="col s12"><br></div>
        <div class="col s12">
            <rs-breadcrumb>
                <rs-breadcrumb-item to="/rs-json" text="Home" />
                <rs-breadcrumb-item to="/rs-json/documentation" text="Documentation" />
                <rs-breadcrumb-item to="/rs-json/documentation/custom-guards" text="Custom guards" />
            </rs-breadcrumb>
        </div>
        <div class="col s12">
            <p class="flow-text">Custom guards can be created by you, the end developer, to extend guards in case <router-link to="/rs-json/documentation/native-guards">native guards</router-link> are not enough.</p>
            <p class="flow-text">Here is a basic example of new guard: longitude (<a href="https://en.wikipedia.org/wiki/Longitude" target="blank">longitudes</a> are floats between -180 and 180 decimal degrees).</p>
        </div>
        <div class="col s12">
            <div class="card">
                <div class="card-tabs">
                    <ul class="tabs tabs-fixed-width">
                    <li class="tab"><a href="#simple-guard-php" class="active">PHP</a></li>
                    <li class="tab"><a href="#simple-guard-javascript">Node</a></li>
                    <li class="tab"><a href="#simple-guard-python">Python 3</a></li>
                    <li class="tab"><a href="#simple-guard-your-language">Your language</a></li>
                    </ul>
                </div>
                <div class="card-content grey lighten-4">
                    <div id="simple-guard-php">
                        <pre><code class="language-PHP">
use RsJson\RsJson;

if (!RsJson::hasGuard('longitude')) {
  RsJson::addGuard('longitude', function($value): bool {
    return -180 <= $value && $value <= 180;
  });
}
</code></pre>
                    </div>
                    <div id="simple-guard-javascript">
                        <pre><code class="language-javascript">
const RsJson = require('rs-json');
// import * as RsJson from 'rs-json';

if (!RsJson.hasGuard('longitude')) {
  RsJson.addGuard('longitude', value => -180 <= value && value <= 180);
}
</code></pre>
                    </div>
                    <div id="simple-guard-python">
                        <pre><code class="language-python">
from rsjson import RsJson

if not RsJson.has_guard('longitude'):
  RsJson.add_guard('longitude', lambda value: -180 <= value and value <= 180)
</code></pre>
                    </div>
                    <div id="simple-guard-your-language">If you whish to feature your implementation in your language, please make an issue. Thank you.</div>
                </div>
            </div>
        </div>
        <div class="col s12">
            <p class="flow-text">Another more complex example: <code>before:field</code>, which check if a property (date) is before another property.</p>
        </div>
        <div class="col s12">
            <div class="card">
                <div class="card-tabs">
                    <ul class="tabs tabs-fixed-width">
                    <li class="tab"><a href="#complex-guard-php" class="active">PHP</a></li>
                    <li class="tab"><a href="#complex-guard-javascript">Node</a></li>
                    <li class="tab"><a href="#complex-guard-python">Python 3</a></li>
                    <li class="tab"><a href="#complex-guard-your-language">Your language</a></li>
                    </ul>
                </div>
                <div class="card-content grey lighten-4">
                    <div id="complex-guard-php">
                        <pre><code class="language-PHP">
use RsJson\RsJson;
use DateTime;
use InvalidArgumentException;

if(!RsJson::hasGuard('before')) {
  RsJson::addGuard('before', function($value, string $parameters, object $property, array $properties): bool {
    if (empty($parameters)) {
      throw new InvalidArgumentException('guard "before" expects a parameter');
    }

    $propertiesNames = array_map(function($property) {
        return $property->name;
    }, $properties);

    if (!in_array($parameters, $propertiesNames)) {
      throw new InvalidArgumentException("missing property $parameters on model {$property->model}");
    }

    return (new DateTime($value)) < (new DateTime($properties[$parameters]->value));
  });
}
</code></pre>
                    </div>
                    <div id="complex-guard-javascript">
                        <pre><code class="language-javascript">
const RsJson = require('rs-json');
// import * as RsJson from 'rs-json';

if (!RsJson.hasGuard('before')) {
  RsJson.addGuard('before', (value, parameters, property, properties) => {
    if(!parameters) {
      throw new Error('guard "before" expects a parameter');
    }

    if(!properties.map(property => property.name).includes(parameters)) {
        throw new Error(`missing property ${parameters} on model ${property.model}`)
    }

    return new Date(value) < new Date(properties[parameters].value)
  });
}
</code></pre>
                    </div>
                    <div id="complex-guard-python">
                        <pre><code class="language-python">
from rsjson import RsJson
from dateutil.parser import parse

if not RsJson.has_guard('before'):
  RsJson.add_guard('before', lambda value, parameters, prop, props: parse(value) < parse(props[parameters].value))
</code></pre>
                    _</div>
                    <div id="complex-guard-your-language">If you whish to feature your implementation in your language, please make an issue. Thank you.</div>
                </div>
            </div>
        </div>
    </div>
</div>